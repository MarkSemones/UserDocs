<html>
<head>
<link href="resources/css/doc-style.css" media="all" rel="stylesheet" type="text/css" />
<script src="//use.typekit.net/jff5neq.js" type="text/javascript"></script>
<script type="text/javascript">
try{Typekit.load();}catch(e){}
</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<title>Setup SSO</title>

<!-- <script> src=”resources/scripts/getAppValues.js” ></script> -->

<script>
function processData(data) {
  $('#signOnUrl').html(data["signOnUrl"]);
  $('#signOutUrl').html(data["signOutUrl"]);
  $('#changePasswordUrl').html(data["changePasswordUrl"]);
  $('#downloadCertificate').html('<a href="' + data["idpCertDownload"] + '">' + data["idpCertDownload"] + '</a>');
   $('#downloadCertificatePem').html('<a href="' + data["idpCertDownload"] + '?fileExtension=pem">' + data["idpCertDownload"] + '</a>');
  $('#idpMetadata').text(data["idpMetadata"]);
  $('#x509CertText').html(data["x509CertText"]);
  $('#x509CertTextPem').html(data["x509CertTextPem"]);
  $('#x509CertTextPem').css("white-space", "pre");
  $('#certFingerPrint').html(data["certFingerPrint"]);
  $('#validFrom').html(data["validFrom"]);
  $('#validTo').html(data["validTo"]);
  $('#issuer').html(data["issuer"]);
$('#metadataUrl').html(data["signOnUrl"]);
 $('#errorUrl').html(data["signOutUrl"]);
 $('#timeoutUrl').html(data["signOutUrl"]);
 $('#delAuthUrl').html(data["delAuthUrl"]);
 $('#saml11SignOnUrl').html(data["saml11SignOnUrl"]);    
}
function getURLParameter(name) {
    return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null;
}
$(document).ready(function($) {
  // This condition is to ensure that the ajax api code is executed only on the intended pages
  if ($('#loginAdminApp').length > 0) {
    var app = getURLParameter('app');
    var subdomain = getURLParameter('subdomain');
    var instanceId = getURLParameter('instanceId');
    var baseAdminUrl = getURLParameter('baseAdminUrl');
    var url;
    if ((subdomain == null && baseAdminUrl == null) || app == null || instanceId == null) {
      $('#loginAdminApp').show();
    } else {
      var endpoint = '/api/internal/v1/setup/help/saml/' + app + '/' + instanceId + '?callback=processData';
      if (baseAdminUrl) {
        url = baseAdminUrl + endpoint;
      } else if (subdomain) {
        url = 'https://' + subdomain + '.okta-admin.com' + endpoint;
      }
      $.ajax({
        type: 'GET',
        url: url,
        jsonp: false,
        jsonpCallback: 'processData',
        dataType: 'jsonp',
        success: function(json) {
          $('#loginAdminApp').hide();
        },
        error: function(e,jqXHR,ajaxSettings,thrownError) {
          $('#loginAdminApp').show();
        },
        timeout: 3000
      });
    }
  }

  
  $('#mailto').on('click', function() {
      var to = "DedicatedSAMLComplaintLine@okta.com"; // I am assuming this will always be same!
      var body = "Dear Okta,%0D%0A%0D%0AI used your SAML setup instruction. I want you to know…%0D%0AI completed the SAML setup?%0D%0AI found errors in this doc?%0D%0A%0D%0AHere’s what I noticed:";
      var subject = "Update Doc:" + $('h1').text();       
      var mailto = "mailto:" + to + "?subject=" + subject + "&body=" + body;
      window.location.href = mailto;
    });

});
</script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
<div class="header clearfix">
        <div class="logo-container">
            <img src="resources/css/okta-logo-white.png" alt="Okta" />
        </div>
    </div>

<div class="okta-instructions">
<div id="loginAdminApp" class="okta-callout okta-error" style="display: none;"><span class="icon-24 icon-error"></span>
<p>This setup might fail without parameter values that are customized for your organization. Please use the Okta Administrator Dashboard to add an application and view the values that are specific for your organization.</p>
</div>
<p>Some of the following fields are required to configure SAML 2.0, but not all. Provide the information requested either in the site for the app for which you are configuring SAML, or an email to support, if that is what the app provider requests.</p>
<p><strong>Note:</strong> Some of the terminology can vary among apps. For example, some apps refer to the Sign Out URL as the&nbsp;Identity Provider HTTP POST URL. Sometimes you might have to look at the sample data provided by an app to determine which field to use.</p>
<ol>
<li><strong>IDP Metadata</strong>: <kbd id="idpMetadata">Sign in to the Okta Admin app to generate this variable.</kbd></li>
<li>&nbsp;<strong>&nbsp;IDP Issuer/Entity ID</strong>:<kbd id="issuer">Sign in to the Okta Admin&nbsp;<span>app to generate this variable.</span></kbd></li>
<li><strong>x.509 Certificate.</strong>&nbsp;Please use <strong>one</strong> of the following certificate formats, as requested by the app provider:</li>
<ul>
<li>x.509 Certificate to download and upload in <strong>.cert Format</strong>:<kbd id="downloadCertificate">Sign in to the Okta Admin&nbsp;<span>app to generate this variable.</span></kbd></li>
<li>x.509 Certificate to cut and paste in <strong>Text Format</strong>:<kbd id="x509CertText">Sign in to the Okta Admin&nbsp;<span>app to generate this variable.</span></kbd></li>
<li>x509 Certificate to cut and paste in <strong>PEM Text Format</strong>:
<pre id="x509CertTextPem">Sign in to the Okta Admin app to generate this variable.</pre>
</li>
<li>x509 Certificate <strong>Fingerprint</strong> to cut and paste:<kbd id="certFingerPrint">Sign in to the Okta Admin&nbsp;<span>app to generate this variable.</span></kbd></li>
</ul>
<li><strong>Login URL/SignOn URL</strong>:&nbsp;<kbd id="signOnUrl"> Sign in to the Okta Admin&nbsp;<span>app to generate this variable.</span></kbd></li>
<li><strong>Logout</strong> <strong>URL/SignOut UR</strong>L:<kbd id="signOutUrl"> Sign in to the Okta Admin&nbsp;<span>app to generate this variable.</span></kbd></li>
</ol></div>
</body>
</html>

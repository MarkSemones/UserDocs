<html>
<head>
    <link href="resources/css/doc-style.css" media="all" rel="stylesheet" type="text/css" />
    <script src="//use.typekit.net/jff5neq.js" type="text/javascript"></script>
    <script type="text/javascript">
        try{Typekit.load();}catch(e){}
    </script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="resources/scripts/vkbeautify.js"></script><script src="resources/scripts/vkbeautify.js"></script>

    <title>Setup SSO</title>

    <script src="resources/scripts/getAppValues.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
<div class="header clearfix">
    <div class="logo-container">
        <img src="resources/css/okta-logo-white.png" alt="Okta" />
    </div>
</div>
<div class="okta-instructions">
<h1>How to Configure SAML 2.0 for Okta Org2Org Application</h1>
    <div id="loginAdminApp" class="okta-callout okta-error" style="display: none;">
        <span class="icon-24 icon-error"></span>
        <p>This setup might fail without parameter values that are customized for your organization. Please use the Okta Administrator Dashboard to add an application and view the values that are specific for your organization.</strong></p>
    </div>
    
    <h2>Overview</h2>
    <p>The Org2Org connector application is used to push/match users from one Okta organization to another. By configuring SAML for this application, users will be authenticated via SAML from one Okta organization to another. This application is used to master in the target (Hub) Okta organization, from the source (Spoke) Okta organization. The Org2Org application was specifically designed for a Hub/Spoke configuration. </p>
    <h2>Assumptions</h2>
    This setup assumes that you are adding this Org2Org SAML Application to your <strong>Okta source (Spoke) organization.</strong>
    <h2> Configuring the Hub/Target Org (Inbound SAML)</h2>
    <ol>
        <li>
            <p>Log into your Okta target organization (Hub) and select the <strong>Admin</strong> button.</p></li>
<li><p>Navigate to <strong>Security > Authentication</strong>, then select the <strong>Inbound SAML</strong> tab to open the interface.</p>

            <p><strong>Note</strong>: All inbound SAML configurations will be created using the spoke/source affiliates name.</p>
        </li>
        <li>
            <p>Click <strong>Add Endpoint</strong> to create a new inbound SAML endpoint for the spoke/source affiliate</strong>.</p>
            <img src="images/apps/org2org.png" alt="org2org.png" width="600" height="590" />
        </li>
        <li><p>Enter the following information:</p>
<ul>
        <li><p><strong>Alias</strong>: Enter the spoke/source org name.</p></li>
        <li><p><strong>IDP Certificate</strong>: Download, then upload the X509 Certificate (below):</p>
            <p><kbd id="downloadCertificate">Sign into the Okta admin app to have this variable generated for you.</kbd></p></li>

<li><p><strong>IDP Issuer</strong>: Copy and paste the following:</p>
            <p><kbd id="issuer">Sign into the Okta admin app to have this variable generated for you.</kbd></p></li>

<li><p><strong>IDP Login URL</strong>: Copy and paste the following:</p>
            <p><kbd id="signOnUrl">Sign in to the Okta Admin app to generate this variable.</kbd></p>
            <p><strong>Note:</strong> You will need this URL for Step 4 under "Configuring Application for Hub/Spoke"</p></li>

<li><p><strong>IDP Bindings</strong>: Set to <strong>HTTP-Post</strong>.</p></li>
<li><p><strong>Default Group Assignment</strong>: Leave this blank.</p></li>
<li><p><strong>Transform Username</strong>: Set to <strong>UserName</strong>.</p></li>
<li><p><strong>Name ID Format</strong>: Set to <strong>Unspecified</strong>.</p></li>
<li><p><strong>Enable SP initiated SAML</strong>: Leave this unchecked.</p></li>

<li><p>Click <strong>Save Endpoint</strong>.</p></li>


</ul>
</li>
                         <li>
            <p>Once you save, you will be brought back on the main Inbound SAML page. Locate the Inbound SAML connection you just created. Copy the <strong>Assertion Consumer Service</strong> & paste it in the <strong>Hub ACS URL</strong> field in your source (spoke) Org2Org Application setup under the <strong>Sign on</strong> tab.</p>
            <p>Next, copy the <strong>Audience URI</strong> and paste it in the <strong>Hub Audience URI</strong> field in your spoke (source) Org2Org Application setup under the <strong>Sign on</strong> tab.</p>
            <p><img src="images/apps/org2org2.png" alt="org2org2.png" width="400" height="250" /></p>
        </li>
        <li>Done!</li>
        </ol>
        <br></br>
        <h2>Configuring Application for Hub/Spoke</h2>
        <p>The following instructions enable users in the Spoke org(s) to login to an application that's managed and provisioned by a single Hub org.</p>
        <ol><li>Follow standard Okta configuration methods for setting the application up in Hub.</li>
        <li>Once configured, locate the App Embedded link under the General Tab of the application. This will become the Default Relay State of the Spoke bookmark application. </li>
        </ol>

        <p>The following example will walk you through the exact steps to perform, using Google Apps as an example.</p>
        

        <p><strong>Note</strong>: Test to ensure the application works correctly in the Hub before configuring the Spoke.</p>
        <ol>
        <li>
            <p>In the Hub org, configure the application that you want to share in spoke org. For this example, we used Google Apps with SAML sign on mode.</p>
            <p><img src="images/apps/org2org4.png" alt="org2org4.png" width="300" height="300" /></p>
        </li>
        <li>
            <p>Log into your source Okta org (spoke), and go to the Admin console. Click on <strong>Add Application</strong>, then add <strong>Bookmark App</strong>.</p>
        </li>
        <li>
            <p>Type in an <strong>Application label</strong> (Hint: Name of the application you are creating - Google Apps in case of our example).</p>
        </li>
        <li>
            <p>You will need 3 things to construct the URL, as follows:</p>
            <ol>
                <li>
                    <p>Copy and paste the <strong>IDP Login URL</strong> to the URL field, from Step 4 above, under 'Configuring the Hub/Target Org (Inbound SAML)'</p>
                </li>
                <li>
                    <p>Add <strong>?RelayState=</strong></p>
                </li>
                <li>
                    <p> Followed by the <strong>Embedded link</strong> of the application in the hub. The <strong>Embedded link</strong> can be found under the <strong>General</strong> tab for Google Apps, or any other application you are configuring.</p>
                </li>
            <p>For Example:</p>
            <kbd>http://sourceorg.okta.com/app/okta_org2org/exkidkmZXAoxbgwz20g3/sso/saml?RelayState=http://huborg.okta.com/home/google/0oaiqwYT8RpdS8I6D0g3/26</kbd>
            <p><img src="images/apps/org2org3.png" alt="org2org3.png" width="500" height="330" /></p>
            </ol>
        <li>
            <p>Done!</p>
<p>Now users can seamlessly log in to Google Apps from spoke org; Google Apps is configured in hub org.</p>
        </li>
        </li>
        </ol>
    
</div>
</body>
</html>

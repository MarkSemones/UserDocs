<html>
<head>
<link href="resources/css/doc-style.css" media="all" rel="stylesheet" type="text/css" />
<script src="//use.typekit.net/jff5neq.js" type="text/javascript"></script>
<script type="text/javascript">
try{Typekit.load();}catch(e){}
</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<title>Setup SSO</title>

<!-- <script> src=”resources/scripts/getAppValues.js” ></script> -->

<script>
function processData(data) {
  $('#signOnUrl').html(data["signOnUrl"]);
  $('#signOutUrl').html(data["signOutUrl"]);
  $('#changePasswordUrl').html(data["changePasswordUrl"]);
  $('#downloadCertificate').html('<a href="' + data["idpCertDownload"] + '">' + data["idpCertDownload"] + '</a>');
   $('#downloadCertificatePem').html('<a href="' + data["idpCertDownload"] + '?fileExtension=pem">' + data["idpCertDownload"] + '</a>');
  $('#idpMetadata').html(data["idpMetadata"]);
  $('#x509CertText').html(data["x509CertText"]);
  $('#x509CertTextPem').html(data["x509CertTextPem"]);
  $('#x509CertTextPem').css("white-space", "pre");
  $('#certFingerPrint').html(data["certFingerPrint"]);
  $('#validFrom').html(data["validFrom"]);
  $('#validTo').html(data["validTo"]);
  $('#issuer').html(data["issuer"]);
$('#metadataUrl').html(data["signOnUrl"]);
 $('#errorUrl').html(data["signOutUrl"]);
 $('#timeoutUrl').html(data["signOutUrl"]);
 $('#delAuthUrl').html(data["delAuthUrl"]);
 $('#saml11SignOnUrl').html(data["saml11SignOnUrl"]);    
}
function getURLParameter(name) {
    return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null;
}
$(document).ready(function($) {
  // This condition is to ensure that the ajax api code is executed only on the intended pages
  if ($('#loginAdminApp').length > 0) {
    var app = getURLParameter('app');
    var subdomain = getURLParameter('subdomain');
    var instanceId = getURLParameter('instanceId');
    var baseAdminUrl = getURLParameter('baseAdminUrl');
    var url;
    if ((subdomain == null && baseAdminUrl == null) || app == null || instanceId == null) {
      $('#loginAdminApp').show();
    } else {
      var endpoint = '/api/internal/v1/setup/help/saml/' + app + '/' + instanceId + '?callback=processData';
      if (baseAdminUrl) {
        url = baseAdminUrl + endpoint;
      } else if (subdomain) {
        url = 'https://' + subdomain + '.okta-admin.com' + endpoint;
      }
      $.ajax({
        type: 'GET',
        url: url,
        jsonp: false,
        jsonpCallback: 'processData',
        dataType: 'jsonp',
        success: function(json) {
          $('#loginAdminApp').hide();
        },
        error: function(e,jqXHR,ajaxSettings,thrownError) {
          $('#loginAdminApp').show();
        },
        timeout: 3000
      });
    }
  }

  
  $('#mailto').on('click', function() {
      var to = "DedicatedSAMLComplaintLine@okta.com"; // I am assuming this will always be same!
      var body = "Dear Okta,%0D%0A%0D%0AI used your SAML setup instruction. I want you to know…%0D%0AI completed the SAML setup?%0D%0AI found errors in this doc?%0D%0A%0D%0AHere’s what I noticed:";
      var subject = "Update Doc:" + $('h1').text();       
      var mailto = "mailto:" + to + "?subject=" + subject + "&body=" + body;
      window.location.href = mailto;
    });

});
</script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
<div class="header clearfix">
        <div class="logo-container">
            <img src="resources/css/okta-logo-white.png" alt="Okta" />
        </div>
    </div>

<div class="okta-instructions">
<div id="loginAdminApp" class="okta-callout okta-error" style="display: none;"><span class="icon-24 icon-error"></span>
<p>This setup might fail without parameter values that are customized for your organization. Please use the Okta Administrator Dashboard to add an application and view the values that are specific for your organization.</p>
</div>
<p>Provide the following&nbsp;<strong>IDP metadata</strong>&nbsp;to OpenAir.</p>
<pre id="idpMetadata">&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;md:EntityDescriptor xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata" entityID="k10dgf3ztSOPRJEXKOEZ"&gt;&lt;md:IDPSSODescriptor WantAuthnRequestsSigned="true" protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol"&gt;&lt;md:KeyDescriptor use="signing"&gt;&lt;ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;&lt;ds:X509Data&gt;&lt;ds:X509Certificate&gt;MIICmTCCAgKgAwIBAgIGAUU+Zd6+MA0GCSqGSIb3DQEBBQUAMIGPMQswCQYDVQQGEwJVUzETMBEG
A1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNU2FuIEZyYW5jaXNjbzENMAsGA1UECgwET2t0YTEU
MBIGA1UECwwLU1NPUHJvdmlkZXIxEDAOBgNVBAMMB2hlaWRpY28xHDAaBgkqhkiG9w0BCQEWDWlu
Zm9Ab2t0YS5jb20wHhcNMTQwNDA3MjI1MjU0WhcNNDQwNDA3MjI1MzU0WjCBjzELMAkGA1UEBhMC
VVMxEzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDVNhbiBGcmFuY2lzY28xDTALBgNVBAoM
BE9rdGExFDASBgNVBAsMC1NTT1Byb3ZpZGVyMRAwDgYDVQQDDAdoZWlkaWNvMRwwGgYJKoZIhvcN
AQkBFg1pbmZvQG9rdGEuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCXVPUrGDW2d1F1
xG+9mGdXctZYFZ+3pSunTbkV6WRpwvJWVlXZHAvxExNVqccyu7kNF5d+GAkVHdpUgPCKBJYKw42y
m8LcJOm3QKtxzpKcZqwsla9aOgbtUKF08BgAoQDHC4DO1wVlj1SubpU9bCoO2HOMvehFoC1Uo8Ws
rvrG+QIDAQABMA0GCSqGSIb3DQEBBQUAA4GBABloQhvxt3rbxTHOCIwU8Yb1q1ObEXyv9Mckodi8
Ly1PT+jODZqmXMVO9zs6m7rHmZu55fUExhpI9X7EerZiD1R0eI4UTxEO0Wod+08SyymJ2cApXq2C
f47i64xir17GvEjpckW+Q0qKDd3Q24Fg9uWtSnb6EOEk6oHAnI0vNyvf&lt;/ds:X509Certificate&gt;&lt;/ds:X509Data&gt;&lt;/ds:KeyInfo&gt;&lt;/md:KeyDescriptor&gt;&lt;md:NameIDFormat&gt;urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress&lt;/md:NameIDFormat&gt;&lt;md:NameIDFormat&gt;urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified&lt;/md:NameIDFormat&gt;&lt;md:SingleSignOnService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" Location="https://heidico.okta.com/app/plateau/k10dgf3ztSOPRJEXKOEZ/sso/saml"/&gt;&lt;md:SingleSignOnService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect" Location="https://heidico.okta.com/app/plateau/k10dgf3ztSOPRJEXKOEZ/sso/saml"/&gt;&lt;/md:IDPSSODescriptor&gt;&lt;/md:EntityDescriptor&gt;</pre></div>
</body>
</html>

<?xml version="1.0" encoding="UTF-8"?>
